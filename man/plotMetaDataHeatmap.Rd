% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_heatmap.R
\name{plotMetaDataHeatmap}
\alias{plotMetaDataHeatmap}
\title{plotMetaDataHeatmap}
\usage{
plotMetaDataHeatmap(
  gobject,
  spat_unit = NULL,
  feat_type = NULL,
  expression_values = c("normalized", "scaled", "custom"),
  metadata_cols = NULL,
  selected_feats = NULL,
  first_meta_col = NULL,
  second_meta_col = NULL,
  show_values = c("zscores", "original", "zscores_rescaled"),
  custom_cluster_order = NULL,
  clus_cor_method = "pearson",
  clus_cluster_method = "complete",
  custom_feat_order = NULL,
  feat_cor_method = "pearson",
  feat_cluster_method = "complete",
  gradient_color = NULL,
  gradient_midpoint = 0,
  gradient_style = c("divergent", "sequential"),
  gradient_limits = NULL,
  x_text_size = 10,
  x_text_angle = 45,
  y_text_size = 10,
  strip_text_size = 8,
  title = NULL,
  plot_title = deprecated(),
  show_plot = NULL,
  return_plot = NULL,
  save_plot = NULL,
  save_param = list(),
  default_save_name = "plotMetaDataHeatmap"
)
}
\arguments{
\item{gobject}{giotto object}

\item{spat_unit}{spatial unit (e.g. "cell")}

\item{feat_type}{feature type (e.g. "rna", "dna", "protein")}

\item{expression_values}{expression values to use
(e.g. "normalized", "scaled", "custom")}

\item{metadata_cols}{annotation columns found in pDataDT(gobject)}

\item{selected_feats}{subset of features to use}

\item{first_meta_col}{if more than 1 metadata column,
select the x-axis factor}

\item{second_meta_col}{if more than 1 metadata column,
select the facetting factor}

\item{show_values}{which values to show on heatmap
(e.g. "zscores", "original", "zscores_rescaled")}

\item{custom_cluster_order}{custom cluster order (default = NULL)}

\item{clus_cor_method}{correlation method for clusters, default to "pearson"}

\item{clus_cluster_method}{hierarchical cluster method for the clusters,
default to "complete"}

\item{custom_feat_order}{custom feature order (default = NULL)}

\item{feat_cor_method}{correlation method for features, default to "pearson"}

\item{feat_cluster_method}{hierarchical cluster method for the features,
default to "complete"}

\item{gradient_color}{character. continuous colors to use. palette to
use or vector of colors to use (minimum of 2).}

\item{gradient_midpoint}{numeric. midpoint for color gradient}

\item{gradient_style}{either 'divergent' (midpoint is used in color scaling)
or 'sequential' (scaled based on data range)}

\item{gradient_limits}{numeric vector with lower and upper limits}

\item{x_text_size}{size of x-axis text}

\item{x_text_angle}{angle of x-axis text}

\item{y_text_size}{size of y-axis text}

\item{strip_text_size}{size of strip text}

\item{title}{character. title for plot, defaults to cell_color parameter}

\item{plot_title}{deprecated. Use title param}

\item{show_plot}{logical. show plot}

\item{return_plot}{logical. return ggplot object}

\item{save_plot}{logical. save the plot}

\item{save_param}{list of saving parameters,
see \code{\link{showSaveParameters}}}

\item{default_save_name}{default save name for saving, don't change,
change save_name in save_param}
}
\value{
ggplot or data.table
}
\description{
Creates heatmap for features within aggregated clusters.
}
\details{
Creates heatmap for the average expression of selected features
in the different annotation/cluster groups.
Calculation of cluster or feature order is done on the provided expression
values, but visualization
is by default on the z-scores. Other options are the original values or
z-scores rescaled per feature (-1 to 1).
}
\examples{
g <- GiottoData::loadGiottoMini("visium", verbose = FALSE)
plotMetaDataHeatmap(g,
    metadata_cols = "leiden_clus",
    selected_feats = c("Gna12", "Ccnd2", "Btbd17", "Gm19935")
)

}
\seealso{
\code{\link{plotMetaDataCellsHeatmap}} for numeric cell annotation
instead of feature expression.
}
